box: perl:5.18.2

build:
  steps:
    - script:
        name: install cpanm
        code: |
          curl -L https://cpanmin.us/ -o cpanm
          chmod +x cpanm
          mv cpanm /usr/bin

    - script:
        name: install carton
        code: |
          cpanm install Carton

    - script:
        name: install dependencies
        code: |
          export PERL_CARTON_PATH=$WERCKER_CACHE_DIR/local
          export PERL_CARTON_CPANFILE=$WERCKER_SOURCE_DIR/cpanfile
          carton install

  after-steps:
    - install-packages:
        packages: ruby2.1

    - script:
        name: alias from ruby2.1 to ruby
        code: |
          ln -s `which ruby2.1` /usr/bin/ruby

    - wantedly/pretty-slack-notify:
        webhook_url: $SLACK_WEBHOOK_URL
